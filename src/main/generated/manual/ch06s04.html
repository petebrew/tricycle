<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>CATRAS</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="manual.html" title="TRiCYCLE Manual"><link rel="up" href="ch06.html" title="Chapter&nbsp;6.&nbsp;Descriptions of file formats"><link rel="prev" href="ch06s03.html" title="Besancon"><link rel="next" href="ch06s05.html" title="Comma Separated Values (CSV)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="section" title="CATRAS"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e685"></a>CATRAS</h2></div></div></div><div class="table"><a name="d0e688"></a><p class="title"><b>Table&nbsp;6.4.&nbsp;Summary of the CATRAS file format</b></p><div class="table-contents"><div class="caption">Summary of the CATRAS file format</div><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><p><span class="strong"><strong>Format Name</strong></span>              </p></td><td><p> CATRAS</p></td></tr><tr><td><p><span class="strong"><strong>Other names</strong></span>              </p></td><td><p>  </p></td></tr><tr><td><p><span class="strong"><strong>Type</strong></span>                     </p></td><td><p> Binary </p></td></tr><tr><td><p><span class="strong"><strong>Extension(s)</strong></span>             </p></td><td><p> .cat </p></td></tr><tr><td><p><span class="strong"><strong>Read/write support</strong></span>       </p></td><td><p> Read only </p></td></tr><tr><td><p><span class="strong"><strong>Reference implementation</strong></span> </p></td><td><p> CATRAS </p></td></tr><tr><td><p><span class="strong"><strong>Data/Metadata</strong></span>            </p></td><td><p> Data and limited structured metadata </p></td></tr><tr><td><p><span class="strong"><strong>Single/Multi series</strong></span>      </p></td><td><p> Single  </p></td></tr><tr><td><p><span class="strong"><strong>Original designer</strong></span>        </p></td><td><p> Roland Aniol </p></td></tr></tbody></table></div></div><br class="table-break"><p></p><div class="section" title="Background"><div class="titlepage"><div><div><h3 class="title"><a name="d0e777"></a>Background</h3></div></div></div><p>The CATRAS format is the only known binary dendro data format.  As such it can't be read by a simple text editor, and can't be imported into spreadsheet or database programs.  The format was designed by Roland Aniol for use in his program of the same name.  The binary nature of the format means the files are typically much smaller than text files containing similar data.  The closed nature of the format originally meant that users were tied to the application, much the fact that users can't manually edit the file means that the validity of files is not a problem like it is with most other dendro formats. </p><p>CATRAS is a closed format with no documentation.  The format was originally decoded in the early 1990's and permission was granted by Aniol for a converter to be included in Henri Grissino-Mayer's CONVERT5 application on the condition that the format remained closed source.  Subsequently others have independently released application and code that can read CATRAS files to a greater or lesser extent.   </p><p>Following its original release in 1983, CATRAS was updated several times, the most recent version we've seen (v4.35) was released in 2003.  Since then CATRAS appears to have been abandoned.  As there has been no development of CATRAS, there is no access to the closed source code and all attempts to contact Aniol have failed, we are justified in publicly releasing details of the CATRAS format to ensure users data are not lost. The code in DendroFileIOLib is based on Matlab, Fortran and C code of Ronald Visser, Henri Grissino-Mayer and Ian Tyers. </p><p></p></div><div class="section" title="Reading byte code"><div class="titlepage"><div><div><h3 class="title"><a name="d0e787"></a>Reading byte code</h3></div></div></div><p>Reading byte code is more complicated than reading text files.  Each byte is 8-bits and  therefore can represent up to 256 values.  Depending on the type of information each byte contains, the bytes are interpreted in one of three ways: </p><p><span class="strong"><strong>Strings</strong></span> </p><p>Some of the bytes in CATRAS files contain character information.  In the case each byte represents a letter.  In java an array of bytes can be directly decoded into  a string. </p><p><span class="strong"><strong>Integers</strong></span> </p><p>As a byte can only represent 256 values, whenever an integer is required, CATRAS stores them as byte pairs.  Each byte pair consists of a least significant byte (LSB) and a  most significant byte (MSB).  The order that they appear in files typically varies between  platforms and is known as 'endianness'.  As CATRAS solely runs of Microsoft (x86) processors  we can safely assume that all CATRAS files will be using little-endian (i.e. LSB MSB). The counting in a byte pair therefore works as follows: </p><div class="table"><a name="d0e804"></a><p class="title"><b>Table&nbsp;6.5.&nbsp;</b></p><div class="table-contents"><div class="caption"></div><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td><p> <span class="strong"><strong>Value</strong></span> </p></td><td><p><span class="strong"><strong>LSB</strong></span> </p></td><td><p> <span class="strong"><strong>MSB</strong></span> </p></td></tr><tr><td><p> 0     </p></td><td><p> 0  </p></td><td><p> 0   </p></td></tr><tr><td><p> 1     </p></td><td><p> 1  </p></td><td><p> 0   </p></td></tr><tr><td><p> 2     </p></td><td><p> 2  </p></td><td><p> 0   </p></td></tr><tr><td><p> ...   </p></td><td><p> ...</p></td><td><p> ... </p></td></tr><tr><td><p> 255   </p></td><td><p> 255</p></td><td><p> 0   </p></td></tr><tr><td><p> 256   </p></td><td><p> 0  </p></td><td><p> 1   </p></td></tr><tr><td><p> 257   </p></td><td><p> 1  </p></td><td><p> 1   </p></td></tr><tr><td><p> 258   </p></td><td><p> 2  </p></td><td><p> 1   </p></td></tr><tr><td><p> ...   </p></td><td><p> ...</p></td><td><p> ... </p></td></tr><tr><td><p> 65536 </p></td><td><p>255 </p></td><td><p> 255 </p></td></tr></tbody></table></div></div><br class="table-break"><p>A byte pair can therefore store 256x256=65536 values (more than enough for most number fields).  Matters are complicated though by the need to store negative  numbers.  In CATRAS pairs with an MSB&lt;=128 are positive, while pairs with an MSB ranging from 255 to 128 (counting backwards) represent negative values </p><p><span class="strong"><strong>Categories</strong></span> </p><p>Categories are typically recorded as single bytes as most categories have just a few possible values. They can therefore be conceptualised as being integers where 0=first option, 1=second option etc. The exception to this is for species as there are more than 256 species.  In this case, a byte pair is used in exactly the same way as described for integers above.  The only problem for species is that the codes are unique to each laboratory and refer to values enumerated in a separate '.wnm' file.  Without this dictionary the species code is of little use. </p><p><span class="strong"><strong>Dates</strong></span> </p><p>Dates are stored as three single bytes, one for day, one for month, one for year.  With only 256 values available for 'year', all dates are stored with 2 digit years e.g. 25/12/84.  When converting to TRiDaS all years &gt;70 are treated as 20th century, whereas years &lt;70 are treated as 21st century. This is an arbitrary decision for use in this library as CATRAS does not care either way. </p><p></p></div><div class="section" title="Metadata"><div class="titlepage"><div><div><h3 class="title"><a name="d0e944"></a>Metadata</h3></div></div></div><p>The first 128 bytes contain the file header information and the remainder of the file  contains the ring width data and sample depth data.  Our current understanding of the  header bytes is as follows but I'm not convinced that these are all correct. Deciphering these requires painstaking work because we must try to ascertain how each byte is being used (e.g. as a byte pair, single byte or as a string): </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">1-32 - Series name </li><li class="listitem">33-40 - Series code </li><li class="listitem">41-44 - File extension </li><li class="listitem">45-46 - Series length </li><li class="listitem">47-48 - Sapwood length </li><li class="listitem">49-50 - Start year </li><li class="listitem">51-52 - End year </li><li class="listitem">53    - 1=pith 2=waldkante 3=pith to waldkante </li><li class="listitem">54    - 1 = ew only last ring </li><li class="listitem">55-56 - Start year </li><li class="listitem">59-60 species also needs a catras.wnm file </li><li class="listitem">61-63 - Creation date </li><li class="listitem">64-66 - Amended date </li><li class="listitem">67    - Sapwood  </li><li class="listitem">68    - 1=valid stats </li><li class="listitem">69-75 - dated? </li><li class="listitem">84    - 0=raw 1=treecurve 2=chronology </li><li class="listitem">85-86 - User id </li><li class="listitem">89-92 - Average width </li><li class="listitem">93-95 - Standard deviation </li><li class="listitem">96-100 - Autocorrelation </li><li class="listitem">101-104 - Sensitivity </li></ul></div><p></p></div><div class="section" title="Data"><div class="titlepage"><div><div><h3 class="title"><a name="d0e995"></a>Data</h3></div></div></div><p>The remaining bytes in the file contain the actual data values stored as integer byte pairs.  It appears that older version of CATRAS included one or more padding values of -1.  These values should be ignored. The end of the data values are indicated by a stop value of 999. </p><p>Following the ring width data values there are 42 bytes of unknown meaning.  These are then followed by byte pairs representing the counts/sample depth for each ring if the series is a chronology.  </p><p></p></div><div class="section" title="Unknown bytes"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1003"></a>Unknown bytes</h3></div></div></div><p>There are a number of bytes in both the header and data sections that are are unaccounted for  and are therefore likely to contain data that we are ignoring.  For this reason although we could attempt to create CATRAS files from what we know we can't be sure they would be valid: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">Header <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">57-58 </li><li class="listitem">69-82 </li><li class="listitem">105-128 </li></ul></div></li><li class="listitem">Data <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">0-42 following end of data marker </li></ul></div></li></ul></div></div></div></body></html>